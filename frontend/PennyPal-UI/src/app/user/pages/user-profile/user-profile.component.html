<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-6">
  <div class="max-w-2xl w-full p-6 bg-white rounded-3xl shadow-xl hover:shadow-2xl transition-all duration-300 border border-gray-100">
    <h2 class="text-2xl font-bold mb-6 text-gray-800 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">User Profile</h2>

    <div class="flex flex-col items-center">
      <!-- Profile Picture -->
      <div class="relative mb-6 group">
        <img
          *ngIf="!changeProfileFlag"
          [src]="user?.profileURL || 'https://via.placeholder.com/100'"
          alt="Profile Picture"
          class="w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg group-hover:scale-105 transition-all duration-300"
        />
        <button
          *ngIf="isEditing && !changeProfileFlag"
          class="px-4 py-2 bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 text-white rounded-lg hover:bg-gradient-to-r hover:from-blue-700 hover:via-purple-700 hover:to-blue-900 mt-3 transform hover:scale-105 transition-all duration-300 active:scale-95"
          (click)="changeProfile()"
        >
          Change Profile
        </button>
        <app-profile-upload
          *ngIf="isEditing && changeProfileFlag"
          (fileSelected)="onProfilePictureChange($event)"
          class="mt-3"
        >
        </app-profile-upload>
      </div>

      <!-- Profile Details -->
      <div class="w-full space-y-6">
        <div>
          <label class="block text-sm font-medium text-gray-700">Name</label>
          <input
            *ngIf="isEditing"
            [(ngModel)]="tempUser.userName"
            type="text"
            class="mt-1 block w-full border border-gray-300 rounded-lg p-3 bg-white bg-opacity-20 backdrop-blur-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
            placeholder="Enter name"
          />
          <p *ngIf="!isEditing" class="mt-1 text-gray-900 font-medium">{{ user?.userName }}</p>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Email</label>

          <!-- View-only mode -->
          <div *ngIf="!isEditing" class="mt-1 text-gray-900 font-medium">
            {{ user?.email || 'N/A' }}
          </div>

          <!-- Edit mode -->
          <div *ngIf="isEditing">
            <!-- Display current email + edit trigger -->
            <div class="mt-1 flex justify-between items-center">
              <p class="text-gray-900 font-medium">{{ user?.email || 'N/A' }}</p>
              <button
                type="button"
                (click)="editEmailFlag = true"
                class="text-blue-600 hover:text-purple-600 hover:underline text-sm transition-all duration-300"
              >
                Change
              </button>
            </div>

            <!-- Email change input -->
            <div *ngIf="editEmailFlag" class="mt-3 space-y-3">
              <label class="block text-sm font-medium text-gray-700">New Email</label>
              <input
                [(ngModel)]="newEmail"
                type="email"
                class="block w-full border border-gray-300 rounded-lg p-3 bg-white bg-opacity-20 backdrop-blur-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                placeholder="Enter new email"
                (input)="resetNewEmail()"
              />
              <p
                [ngClass]="checkEmail ? 'text-green-600' : 'text-red-600'"
                *ngIf="EmailCheckStatus"
                class="text-sm font-medium"
              >
                {{ EmailCheckStatus }}
              </p>
              <button
                type="button"
                class="px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:bg-gradient-to-r hover:from-green-600 hover:to-green-700 transform hover:scale-105 transition-all duration-300 active:scale-95"
                [disabled]="checkEmail"
                (click)="checkEmailAvailability()"
              >
                Check
              </button>

              <!-- Send OTP Button -->
              <button
                *ngIf="checkEmail && !otpSent"
                (click)="sendOtpToEmail()"
                class="px-4 py-2 bg-gradient-to-r from-indigo-500 to-indigo-600 text-white rounded-lg hover:bg-gradient-to-r hover:from-indigo-600 hover:to-indigo-700 transform hover:scale-105 transition-all duration-300 active:scale-95"
              >
                Send OTP
              </button>

              <!-- Enter OTP Section -->
              <div *ngIf="otpSent && !emailVerified" class="space-y-3">
                <label class="block text-sm font-medium text-gray-700">Enter OTP</label>
                <input
                  [(ngModel)]="otp"
                  type="text"
                  class="block w-full border border-gray-300 rounded-lg p-3 bg-white bg-opacity-20 backdrop-blur-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                  placeholder="Enter OTP"
                />
                <button
                  (click)="verifyOtp()"
                  class="px-4 py-2 bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 text-white rounded-lg hover:bg-gradient-to-r hover:from-blue-700 hover:via-purple-700 hover:to-blue-900 transform hover:scale-105 transition-all duration-300 active:scale-95"
                >
                  Verify OTP
                </button>
              </div>

              <!-- Success Message -->
              <p *ngIf="emailVerified" class="text-green-600 font-medium">Email verified!</p>
            </div>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Phone</label>
          <input
            *ngIf="isEditing"
            [(ngModel)]="tempUser.phone"
            type="tel"
            class="mt-1 block w-full border border-gray-300 rounded-lg p-3 bg-white bg-opacity-20 backdrop-blur-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
            placeholder="Enter phone number"
          />
          <p *ngIf="!isEditing" class="mt-1 text-gray-900 font-medium">{{ user?.phone || 'N/A' }}</p>
        </div>
      </div>

      <!-- Buttons -->
      <div class="mt-6 flex justify-end space-x-3 w-full">
        <button
          *ngIf="!isEditing"
          (click)="startEditing()"
          class="px-4 py-2 bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 text-white rounded-lg hover:bg-gradient-to-r hover:from-blue-700 hover:via-purple-700 hover:to-blue-900 transform hover:scale-105 transition-all duration-300 active:scale-95"
        >
          Edit
        </button>
        <button
          *ngIf="isEditing"
          (click)="saveChanges()"
          class="px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:bg-gradient-to-r hover:from-green-600 hover:to-green-700 transform hover:scale-105 transition-all duration-300 active:scale-95"
        >
          Save
        </button>
        <button
          *ngIf="isEditing"
          (click)="cancelEditing()"
          class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transform hover:scale-105 transition-all duration-300 active:scale-95"
        >
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>