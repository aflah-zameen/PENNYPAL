<app-modal-overlay [isOpen]="isModalOpen" (close)="onClose()">
  <!-- Modal Header -->
  <div class="text-center mb-6">
    <div class="mx-auto w-12 h-12 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center mb-2 mt-5">
      <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
      </svg>
    </div>
    <h1 class="text-2xl font-bold bg-gradient-to-r from-green-600 via-blue-600 to-green-800 bg-clip-text text-transparent">
      Add Income
    </h1>
    <p class="text-gray-600 text-sm mt-1">Enter amount, category, and source details</p>
  </div>

  <!-- Modal Body -->
  <div class="px-6 pb-6">
    <form (ngSubmit)="onSubmit()" class="grid grid-cols-1 md:grid-cols-2 gap-5">

     <!-- Amount -->
      <div class="col-span-1">
        <label class="block text-sm font-semibold text-gray-700 mb-1">Amount <span class="text-red-500">*</span></label>
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <span class="text-gray-500 text-lg font-medium">$</span>
          </div>
          <input
            type="number"
            [(ngModel)]="formData.amount"
            name="amount"
            placeholder="0.00"
            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 bg-gray-50 focus:bg-white transition-all duration-200"
            [class.border-red-500]="errors.amount"
            required
          />
        </div>
        <p *ngIf="errors.amount" class="mt-1 text-sm text-red-600">{{ errors.amount }}</p>
      </div>

      <!-- Category -->
      <div class="col-span-1">
        <label class="block text-sm font-semibold text-gray-700 mb-1">Category <span class="text-red-500">*</span></label>
        <div class="relative">
          <select
            [(ngModel)]="formData.categoryId"
            name="category"
            required
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 bg-gray-50 focus:bg-white transition-all duration-200"
            [class.border-red-500]="errors.category"
          >
            <option value="" disabled>Select Category</option>
            <option *ngFor="let category of categories" [ngValue]="category.id">{{ category.name }}</option>
          </select>
          <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none">
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </div>
        <p *ngIf="errors.category" class="mt-1 text-sm text-red-600">{{ errors.category }}</p>
      </div>

      <!-- Source Details -->
      <div class="col-span-1">
        <label class="block text-sm font-semibold text-gray-700 mb-1">Source Details <span class="text-red-500">*</span></label>
        <input
          type="text"
          [(ngModel)]="formData.title"
          name="sourceDetail"
          placeholder="e.g., Freelance, Salary, Refund"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 bg-gray-50 focus:bg-white transition-all duration-200"
          [class.border-red-500]="errors.sourceDetail"
          required
        />
        <p *ngIf="errors.sourceDetail" class="mt-1 text-sm text-red-600">{{ errors.sourceDetail }}</p>
      </div>

      <!-- Date -->
      <div class="col-span-1">
        <label class="block text-sm font-semibold text-gray-700 mb-1">Date <span class="text-red-500">*</span></label>
        <input
          type="date"
          [(ngModel)]="formData.incomeDate"
          name="income_date"
          required
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 bg-gray-50 focus:bg-white transition-all duration-200"
          [class.border-red-500]="errors.income_date"
        />
        <p *ngIf="errors.income_date" class="mt-1 text-sm text-red-600">{{ errors.income_date }}</p>
      </div>


      <!-- Notes -->
      <div class="col-span-1 md:col-span-2">
        <label class="block text-sm font-semibold text-gray-700 mb-1">Notes <span class="text-gray-400 text-xs">(Optional)</span></label>
        <textarea
          [(ngModel)]="formData.description"
          name="notes"
          rows="2"
          placeholder="Add additional details..."
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 bg-gray-50 focus:bg-white resize-none"
        ></textarea>
      </div>

      <!-- Error Message -->
      <div *ngIf="errors.general" class="col-span-1 md:col-span-2 p-3 bg-red-50 border border-red-200 rounded-lg">
        <p class="text-sm text-red-600">{{ errors.general }}</p>
      </div>

      <!-- Modal Footer -->
      <div class="col-span-1 md:col-span-2 flex justify-end space-x-3 pt-4 border-t border-gray-100 mt-4">
        <button
          type="button"
          (click)="close.emit()"
          class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-300 font-medium"
        >
          Cancel
        </button>
        <button
          type="submit"
          [disabled]="isSubmitting"
          class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-semibold py-2 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2"
        >
          <svg *ngIf="isSubmitting" class="animate-spin w-4 h-4" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
            </path>
          </svg>
          <span>{{ isSubmitting ? 'Adding Income...' : 'Add Income' }}</span>
        </button>
      </div>
    </form>
  </div>
</app-modal-overlay>
