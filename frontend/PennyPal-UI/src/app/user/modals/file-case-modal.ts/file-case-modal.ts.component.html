<app-modal-overlay [isOpen]="isOpen" (close)="onClose()" *ngIf="loan">
  <!-- Header -->
  <div class="bg-gradient-to-r from-red-600 via-pink-600 to-red-800 text-white p-6 rounded-t-3xl">
    <h2 class="text-2xl font-bold">File Case Against Borrower</h2>
    <p class="text-sm text-red-100 mt-1">This action will be reviewed by the admin team</p>
  </div>

  <!-- Content -->
  <div class="p-6 space-y-6 bg-gradient-to-br from-blue-50 via-white to-purple-50 rounded-b-3xl">
    
    <!-- Loan Summary -->
    <div class="bg-white rounded-2xl shadow-md border border-gray-100 p-4 space-y-2">
      <div class="flex justify-between text-sm text-gray-600">
        <span>Borrower</span>
        <span class="font-semibold text-gray-800">{{ loan.borrowerName }}</span>
      </div>
      <div class="flex justify-between text-sm text-gray-600">
        <span>Amount</span>
        <span class="font-semibold text-green-600">₹{{ loan.amount | number:'1.2-2' }}</span>
      </div>
      <div class="flex justify-between text-sm text-gray-600">
        <span>Due Date</span>
        <span class="font-semibold text-red-600">{{ lendingService.formatDate(loan.repaymentDeadline) }}</span>
      </div>
      <div class="flex justify-between text-sm text-gray-600">
        <span>Days Overdue</span>
        <span class="font-semibold text-red-700">{{ loan.daysPastDue }}</span>
      </div>
    </div>

    <!-- Reason Input -->
    <div>
      <label for="reason" class="block text-sm font-medium text-gray-700 mb-1">Reason for Filing</label>
      <textarea id="reason"
                [(ngModel)]="reason"
                rows="4"
                class="w-full px-4 py-3 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-red-500 focus:outline-none transition-all duration-300 resize-none"
                placeholder="Explain why you're filing this case..."
                required></textarea>
      <p *ngIf="reasonError" class="text-red-500 text-xs mt-1">{{ reasonError }}</p>
    </div>

    <!-- Info Message -->
    <div class="text-sm text-gray-500 bg-yellow-50 border border-yellow-200 rounded-xl p-3">
      Once submitted, this case will be reviewed by the PennyPal admin team. Action may take up to <span class="font-semibold text-yellow-700">24–48 hours</span> depending on severity and case volume.
    </div>

    <!-- Action Buttons -->
    <div class="flex justify-end space-x-3">
      <button (click)="onClose()"
              class="px-5 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-all duration-300 active:scale-95">
        Cancel
      </button>
      <button (click)="submitCase()"
              [disabled]="!reason || isSubmitting"
              class="px-5 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg font-medium hover:shadow-lg transition-all duration-300 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center">
        <svg *ngIf="isSubmitting" class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
          </path>
        </svg>
        {{ isSubmitting ? 'Submitting...' : 'Submit Case' }}
      </button>
    </div>
  </div>
</app-modal-overlay>
